!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).fireworks=i()}(this,(function(){"use strict";var t,i,s;s=function(t,i){return Math.random()*(i-t)+t},i=function(t,i){return 0|s(t,i)},t=function(t,i,s,h){return Math.sqrt(Math.pow(t-s,2)+Math.pow(i-h,2))};const h={fireworkSpeed:2,fireworkAcceleration:1.05,particleFriction:.95,particleGravity:1.5};const e=class{constructor(s,e,r,n,a,o){var c,d;for(this.x=s,this.y=e,this.sx=s,this.sy=e,this.dx=r,this.dy=n,this.ctx=a,this.hue=o,this.totalDistance=t(this.sx,this.sy,this.dx,this.dy),this.currentDistance=0,this.coordinates=[],this.coordinateCount=3,this.angle=Math.atan2(this.dy-this.sy,this.dx-this.sx),this.speed=h.fireworkSpeed,this.acceleration=h.fireworkAcceleration,this.brightness=i(50,70),c=0,d=this.coordinateCount;0<=d?c<d:c>d;0<=d?++c:--c)this.coordinates.push([this.x,this.y])}update(i){var s,h;return this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.acceleration,s=Math.cos(this.angle)*this.speed,h=Math.sin(this.angle)*this.speed,this.currentDistance=t(this.sx,this.sy,this.x+s,this.y+h),this.currentDistance>=this.totalDistance?i(this.dx,this.dy,this.hue):(this.x+=s,this.y+=h)}draw(){var t;return t=this.coordinates.length-1,this.ctx.beginPath(),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=`hsl(${this.hue}, 100%, ${this.brightness}%)`,this.ctx.stroke()}};var r;r=2*Math.PI;const n=class{constructor(t,e,n,a){var o,c;for(this.x=t,this.y=e,this.ctx=n,this.hue=a,this.coordinates=[],this.coordinateCount=5,this.angle=s(0,r),this.speed=s(1,10),this.hue=i(this.hue-20,this.hue+20),this.friction=h.particleFriction,this.gravity=h.particleGravity,this.brightness=i(50,90),this.alpha=1,this.decay=s(.015,.03),o=0,c=this.coordinateCount;0<=c?o<c:o>c;0<=c?++o:--o)this.coordinates.push([this.x,this.y])}update(t){if(this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.friction,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed+this.gravity,this.alpha-=this.decay,this.alpha<=this.decay)return t()}draw(){var t;return t=this.coordinates.length-1,this.ctx.beginPath(),this.ctx.moveTo(this.coordinates[t][0],this.coordinates[t][1]),this.ctx.lineTo(this.x,this.y),this.ctx.strokeStyle=`hsla(${this.hue}, 100%, ${this.brightness}%, ${this.alpha})`,this.ctx.stroke()}};return class{constructor(t){this.canvas=document.getElementById(t.id||"fireworks-canvas"),this.ctx=this.canvas.getContext?this.canvas.getContext("2d"):null,this.width=this.canvas.width,this.height=this.canvas.height,this.hue=t.hue||120,this.isRunning=!1,this.fireworks=[],this.particles=[],this.particleCount=t.particleCount||50,this.tick=0,this.delay=t.delay||30,this.minDelay=t.minDelay||30,this.maxDelay=t.maxDelay||90,this.boundaries=t.boundaries||{top:50,bottom:.5*this.height,left:50,right:this.width-50},this.render.bind(this)}start(){return this.isRunning=!0,this.fireworks=[],this.particles=[],this.render()}stop(){return this.isRunning=!1,this.clear()}clear(){if(this.ctx)return this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(0,0,this.width,this.height)}render(){var t,s;if(this.ctx&&this.isRunning){for(window.requestAnimationFrame(this.render.bind(this)),t=this,this.hue+=.5,this.ctx.globalCompositeOperation="destination-out",this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.globalCompositeOperation="lighter",s=this.fireworks.length;s--;)this.fireworks[s].draw(),this.fireworks[s].update((function(i,h,e){var r;for(r=t.particleCount;r--;)t.particles.push(new n(i,h,t.ctx,e));return t.fireworks.splice(s,1)}));for(s=this.particles.length;s--;)this.particles[s].draw(),this.particles[s].update((function(){return t.particles.splice(s,1)}));return this.tick===this.delay&&(this.fireworks.push(new e(.5*this.width,this.height,i(this.boundaries.left,this.boundaries.right),i(this.boundaries.top,this.boundaries.bottom),this.ctx,this.hue)),this.delay=i(this.minDelay,this.maxDelay),this.tick=0),this.tick++}}}}));
